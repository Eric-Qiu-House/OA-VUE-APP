"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[2342],{92852:function(e,t,o){o.r(t),o.d(t,{default:function(){return n}});var a=o(51464);function r(e,t,o,r,s,l){const i=(0,a.g2)("el-tree"),n=(0,a.g2)("el-card"),c=(0,a.g2)("el-col"),d=(0,a.g2)("el-button"),u=(0,a.g2)("el-table-column"),h=(0,a.g2)("el-table"),p=(0,a.g2)("el-row"),b=(0,a.g2)("el-main"),g=(0,a.gN)("loading");return(0,a.uX)(),(0,a.Wv)(b,null,{default:(0,a.k6)((()=>[(0,a.bF)(p,{gutter:15},{default:(0,a.k6)((()=>[(0,a.bF)(c,{lg:3},{default:(0,a.k6)((()=>[(0,a.bF)(n,{header:"项目编号"},{default:(0,a.k6)((()=>[(0,a.bo)((0,a.bF)(i,{style:{"max-width":"600px"},data:s.projectData,"node-key":"id_",props:s.defaultProps,onNodeClick:l.handleNodeClick},null,8,["data","props","onNodeClick"]),[[g,s.proNumLoading]])])),_:1})])),_:1}),(0,a.bF)(c,{lg:21},{default:(0,a.k6)((()=>[(0,a.bF)(n,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{type:"primary",icon:"el-icon-plus",disabled:!e.$isButtonVisible,onClick:l.add},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("工时导出")]))),_:1},8,["disabled","onClick"]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(h,{ref:"usersData",data:s.usersData,onSelectionChange:l.selectionChange,stripe:"",remoteSort:"",remoteFilter:""},{default:(0,a.k6)((()=>[(0,a.bF)(u,{label:"审批单号",prop:"审批单号",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"图号",prop:"图号",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"图名",prop:"图名",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"人员",prop:"人员",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"工时",prop:"工时",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"工时日期",prop:"工时日期",width:"150",sortable:"custom"}),(0,a.bF)(u,{label:"审批人",prop:"审批人",width:"150",sortable:"custom"})])),_:1},8,["data","onSelectionChange"])),[[g,s.manhoursLoading]])])),_:1})])),_:1})])),_:1})])),_:1})}o(84535),o(91554),o(325);var s={data(){return{defaultProps:{label:"project_number_"},projectId:"",selection:[],projectData:[],usersData:[],proNumLoading:!1,manhoursLoading:!1}},created(){this.getProjectInfo()},methods:{async getProjectInfo(){this.proNumLoading=!0;try{this.projectData=await this.$dmsApi.project.readAll.get()}catch(e){console.error("Error fetching user list:",e)}finally{this.proNumLoading=!1}},async handleNodeClick(e){this.projectId=e.uuid_;const t={project_id_:e.uuid_};this.manhoursLoading=!0;try{const e=await this.$dmsApi.manHours.readByProjectManhours.post(t);this.usersData=e,this.$nextTick((()=>{console.log(this.usersData,"this.usersData")}))}catch(o){console.error("Error fetching user list:",o)}finally{this.manhoursLoading=!1}},async add(){try{const e={project_id_:this.projectId},t=await this.$dmsApi.manHours.readByProjectManhoursCsv.post(e),o=window.URL.createObjectURL(new Blob([t])),a=document.createElement("a");a.href=o,a.setAttribute("download","project_manhours.csv"),document.body.appendChild(a),a.click()}catch(e){console.error("Error fetching user list:",e)}},selectionChange(e){this.selection=e}}},l=o(51456);const i=(0,l.A)(s,[["render",r]]);var n=i}}]);